{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport { Controller } from '@hotwired/stimulus';\nimport * as FilePond from 'filepond';\nimport FilePondPluginFilePoster from 'filepond-plugin-file-poster';\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview';\nimport FilePondPluginFileValidateSize from 'filepond-plugin-file-validate-size';\nimport FilePondPluginFileValidateType from 'filepond-plugin-file-validate-type';\nimport FilePondPluginImageExifOrientation from 'filepond-plugin-image-exif-orientation';\nimport 'filepond/dist/filepond.min.css';\nimport 'filepond-plugin-file-poster/dist/filepond-plugin-file-poster.css';\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css';\nFilePond.registerPlugin(FilePondPluginFilePoster, FilePondPluginImagePreview, FilePondPluginImageExifOrientation, FilePondPluginFileValidateType, FilePondPluginFileValidateSize);\nvar baseOptions = {\n  storeAsFile: true,\n  maxFileSize: '5MB',\n  labelIdle: 'Drag & drop here'\n};\nvar avatarExtraOptions = {\n  imagePreviewHeight: 200,\n  imageCropAspectRatio: '1:1',\n  imageResizeTargetWidth: 200,\n  imageResizeTargetHeight: 200,\n  styleLoadIndicatorPosition: 'center bottom',\n  styleButtonRemoveItemPosition: 'center bottom',\n  stylePanelLayout: 'compact circle'\n};\n\nvar _default = /*#__PURE__*/function (_Controller) {\n  _inherits(_default, _Controller);\n\n  var _super = _createSuper(_default);\n\n  function _default() {\n    _classCallCheck(this, _default);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(_default, [{\n    key: \"inputTargetConnected\",\n    value: function inputTargetConnected(inputTarget) {\n      this.setupFilePond(inputTarget);\n    }\n  }, {\n    key: \"setupFilePond\",\n    value: function setupFilePond(inputTarget) {\n      var options = _objectSpread({}, baseOptions);\n\n      var _inputTarget$dataset = inputTarget.dataset,\n          styleLayout = _inputTarget$dataset.styleLayout,\n          files = _inputTarget$dataset.files;\n\n      if (styleLayout === 'avatar') {\n        options = _objectSpread(_objectSpread({}, options), avatarExtraOptions);\n      }\n\n      if (files) {\n        options = _objectSpread(_objectSpread({}, options), {}, {\n          files: JSON.parse(files)\n        });\n      }\n\n      var instance = FilePond.create(inputTarget, _objectSpread(_objectSpread({}, options), {}, {\n        oninit: function oninit() {\n          // prevent submit existing files load from server\n          var inputElement = instance.element.querySelector('.filepond--data input');\n          inputElement === null || inputElement === void 0 ? void 0 : inputElement.remove();\n        }\n      }));\n    }\n  }]);\n\n  return _default;\n}(Controller);\n\n_default.targets = ['input'];\nexport { _default as default };","map":{"version":3,"names":["Controller","FilePond","FilePondPluginFilePoster","FilePondPluginImagePreview","FilePondPluginFileValidateSize","FilePondPluginFileValidateType","FilePondPluginImageExifOrientation","registerPlugin","baseOptions","storeAsFile","maxFileSize","labelIdle","avatarExtraOptions","imagePreviewHeight","imageCropAspectRatio","imageResizeTargetWidth","imageResizeTargetHeight","styleLoadIndicatorPosition","styleButtonRemoveItemPosition","stylePanelLayout","inputTarget","setupFilePond","options","dataset","styleLayout","files","JSON","parse","instance","create","oninit","inputElement","element","querySelector","remove","targets"],"sources":["/home/johnny/Documents/Rails/peace_tree/app/javascript/controllers/shared/filepond_controller.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport * as FilePond from 'filepond';\nimport FilePondPluginFilePoster from 'filepond-plugin-file-poster';\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview';\nimport FilePondPluginFileValidateSize from 'filepond-plugin-file-validate-size';\nimport FilePondPluginFileValidateType from 'filepond-plugin-file-validate-type';\nimport FilePondPluginImageExifOrientation from 'filepond-plugin-image-exif-orientation';\n\nimport 'filepond/dist/filepond.min.css';\nimport 'filepond-plugin-file-poster/dist/filepond-plugin-file-poster.css';\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css';\n\nFilePond.registerPlugin(\n  FilePondPluginFilePoster,\n  FilePondPluginImagePreview,\n  FilePondPluginImageExifOrientation,\n  FilePondPluginFileValidateType,\n  FilePondPluginFileValidateSize,\n);\n\nvar baseOptions = {\n  storeAsFile: true,\n  maxFileSize: '5MB',\n  labelIdle: 'Drag & drop here'\n};\nvar avatarExtraOptions = {\n  imagePreviewHeight: 200,\n  imageCropAspectRatio: '1:1',\n  imageResizeTargetWidth: 200,\n  imageResizeTargetHeight: 200,\n  styleLoadIndicatorPosition: 'center bottom',\n  styleButtonRemoveItemPosition: 'center bottom',\n  stylePanelLayout: 'compact circle',\n}\n\nexport default class extends Controller {\n  static targets = ['input'];\n\n  inputTargetConnected(inputTarget) {\n    this.setupFilePond(inputTarget);\n  }\n\n  setupFilePond(inputTarget) {\n    let options = { ...baseOptions };\n    var { dataset: { styleLayout, files } } = inputTarget;\n\n    if (styleLayout === 'avatar') {\n      options = { ...options, ...avatarExtraOptions };\n    }\n\n    if (files) {\n      options = { ...options, files: JSON.parse(files) };\n    }\n\n    var instance = FilePond.create(inputTarget, {\n      ...options,\n      oninit: () => {\n        // prevent submit existing files load from server\n        var inputElement = instance.element.querySelector('.filepond--data input');\n        inputElement?.remove();\n      }\n    });\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,UAAT,QAA2B,oBAA3B;AACA,OAAO,KAAKC,QAAZ,MAA0B,UAA1B;AACA,OAAOC,wBAAP,MAAqC,6BAArC;AACA,OAAOC,0BAAP,MAAuC,+BAAvC;AACA,OAAOC,8BAAP,MAA2C,oCAA3C;AACA,OAAOC,8BAAP,MAA2C,oCAA3C;AACA,OAAOC,kCAAP,MAA+C,wCAA/C;AAEA,OAAO,gCAAP;AACA,OAAO,kEAAP;AACA,OAAO,sEAAP;AAEAL,QAAQ,CAACM,cAAT,CACEL,wBADF,EAEEC,0BAFF,EAGEG,kCAHF,EAIED,8BAJF,EAKED,8BALF;AAQA,IAAII,WAAW,GAAG;EAChBC,WAAW,EAAE,IADG;EAEhBC,WAAW,EAAE,KAFG;EAGhBC,SAAS,EAAE;AAHK,CAAlB;AAKA,IAAIC,kBAAkB,GAAG;EACvBC,kBAAkB,EAAE,GADG;EAEvBC,oBAAoB,EAAE,KAFC;EAGvBC,sBAAsB,EAAE,GAHD;EAIvBC,uBAAuB,EAAE,GAJF;EAKvBC,0BAA0B,EAAE,eALL;EAMvBC,6BAA6B,EAAE,eANR;EAOvBC,gBAAgB,EAAE;AAPK,CAAzB;;;;;;;;;;;;;;;WAaE,8BAAqBC,WAArB,EAAkC;MAChC,KAAKC,aAAL,CAAmBD,WAAnB;IACD;;;WAED,uBAAcA,WAAd,EAA2B;MACzB,IAAIE,OAAO,qBAAQd,WAAR,CAAX;;MACA,2BAA0CY,WAA1C,CAAMG,OAAN;MAAA,IAAiBC,WAAjB,wBAAiBA,WAAjB;MAAA,IAA8BC,KAA9B,wBAA8BA,KAA9B;;MAEA,IAAID,WAAW,KAAK,QAApB,EAA8B;QAC5BF,OAAO,mCAAQA,OAAR,GAAoBV,kBAApB,CAAP;MACD;;MAED,IAAIa,KAAJ,EAAW;QACTH,OAAO,mCAAQA,OAAR;UAAiBG,KAAK,EAAEC,IAAI,CAACC,KAAL,CAAWF,KAAX;QAAxB,EAAP;MACD;;MAED,IAAIG,QAAQ,GAAG3B,QAAQ,CAAC4B,MAAT,CAAgBT,WAAhB,kCACVE,OADU;QAEbQ,MAAM,EAAE,kBAAM;UACZ;UACA,IAAIC,YAAY,GAAGH,QAAQ,CAACI,OAAT,CAAiBC,aAAjB,CAA+B,uBAA/B,CAAnB;UACAF,YAAY,SAAZ,IAAAA,YAAY,WAAZ,YAAAA,YAAY,CAAEG,MAAd;QACD;MANY,GAAf;IAQD;;;;EA3B0BlC,U;;SACpBmC,O,GAAU,CAAC,OAAD,C"},"metadata":{},"sourceType":"module"}